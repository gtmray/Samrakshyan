{"version":3,"file":"wavesurfer.playhead.js","mappings":"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","sources":["webpack://WaveSurfer/webpack/universalModuleDefinition","webpack://WaveSurfer/./src/plugin/playhead/index.js","webpack://WaveSurfer/webpack/bootstrap","webpack://WaveSurfer/webpack/before-startup","webpack://WaveSurfer/webpack/startup","webpack://WaveSurfer/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"playhead\"] = factory();\n})(self, () => {\nreturn ","\n/**\n * The playhead plugin separates the notion of the currently playing position from\n * a 'play-start' position.  Having a playhead enables a listening pattern\n * (commonly found in DAWs) that involves listening to a section of a track\n * repeatedly, rather than listening to an entire track in a linear fashion.\n *\n * @implements {PluginClass}\n *\n * @example\n * import PlayheadPlugin from 'wavesurfer.playhead.js';\n *\n * // if you are using <script> tags\n * var PlayheadPlugin = window.WaveSurfer.playhead;\n *\n * // ... initialising wavesurfer with the plugin\n * var wavesurfer = WaveSurfer.create({\n *   // wavesurfer options ...\n *   plugins: [\n *     PlayheadPlugin.create({\n *        movePlayheadOnSeek: true,\n *        drawPlayhead: false,\n *        movePlayheadOnPause: false\n *     })\n *   ]\n * });\n */\n\nconst DEFAULT_FILL_COLOR = '#CF2F00';\n\nexport default class PlayheadPlugin {\n    /**\n     * @typedef {Object} PlayheadPluginParams\n     * @property {?boolean} draw=true Draw the playhead as a triangle/line\n     * @property {?boolean} moveOnSeek=true Seeking (via clicking) while playing moves the playhead\n     * @property {?boolean} returnOnPause=true Pausing the track returns the seek position to the playhead\n     */\n\n    /**\n     * Playhead plugin definition factory\n     *\n     * This function must be used to create a plugin definition which can be\n     * used by wavesurfer to correctly instantiate the plugin.\n     *\n     * @param {PlayheadPluginParams} params parameters use to initialise the plugin\n     * @since 5.0.0\n     * @return {PluginDefinition} an object representing the plugin\n     */\n    static create(params) {\n        return {\n            name: 'playhead',\n            deferInit: params && params.deferInit ? params.deferInit : false,\n            params: params,\n            instance: PlayheadPlugin\n        };\n    }\n\n    constructor(params, ws) {\n        this.params = params;\n        this.options = {};\n\n        ['draw', 'moveOnSeek', 'returnOnPause'].forEach(opt => {\n            if (opt in params) {\n                this.options[opt] = params[opt];\n            } else {\n                this.options[opt] = true;\n            }\n        });\n\n\n        this.wavesurfer = ws;\n        this.util = ws.util;\n        this.style = this.util.style;\n        this.markerWidth = 21;\n        this.markerHeight = 16;\n        this.playheadTime = 0;\n        this.unFuns = [];\n\n        this._onResize = () => {\n            this._updatePlayheadPosition();\n        };\n\n        this._onReady = () => {\n            this.wrapper = this.wavesurfer.drawer.wrapper;\n            this._updatePlayheadPosition();\n        };\n    }\n\n    _onBackendCreated() {\n        this.wrapper = this.wavesurfer.drawer.wrapper;\n\n        if (this.options.draw) {\n            this._createPlayheadElement();\n            window.addEventListener('resize', this._onResize, true);\n            window.addEventListener('orientationchange', this._onResize, true);\n\n            this.wavesurferOn('zoom', this._onResize);\n        }\n\n        this.wavesurferOn('pause', () => {\n            if ( this.options.returnOnPause ) {\n                this.wavesurfer.setCurrentTime(this.playheadTime);\n            }\n        });\n\n        this.wavesurferOn('seek', () => {\n            if ( this.options.moveOnSeek ) {\n                this.playheadTime = this.wavesurfer.getCurrentTime();\n                this._updatePlayheadPosition();\n            }\n        });\n\n        this.playheadTime = this.wavesurfer.getCurrentTime();\n    }\n\n    wavesurferOn(ev, fn) {\n        let ret = this.wavesurfer.on(ev, fn);\n        this.unFuns.push(() => {\n            this.wavesurfer.un(ev, fn);\n        });\n        return ret;\n    }\n\n    init() {\n        if (this.wavesurfer.isReady) {\n            this._onBackendCreated();\n            this._onReady();\n        } else {\n            let r;\n\n            this.wavesurfer.once('ready', () => this._onReady());\n            this.wavesurfer.once('backend-created', () => this._onBackendCreated());\n        }\n    }\n\n    destroy() {\n        this.unFuns.forEach(f => f());\n        this.unFuns = [];\n\n        this.wrapper.removeChild(this.element);\n\n        window.removeEventListener('resize', this._onResize, true);\n        window.removeEventListener('orientationchange', this._onResize, true);\n    }\n\n    setPlayheadTime(time) {\n        this.playheadTime = time;\n\n        if (!this.wavesurfer.isPlaying()) {\n            this.wavesurfer.setCurrentTime(time);\n        }\n        this._updatePlayheadPosition();\n    }\n\n    _createPointerSVG() {\n        const svgNS = 'http://www.w3.org/2000/svg';\n\n        const el = document.createElementNS(svgNS, 'svg');\n        const path = document.createElementNS(svgNS, 'path');\n\n        el.setAttribute('viewBox', '0 0 33 30');\n        path.setAttribute('d', 'M16.75 31 31.705 5.566A3 3 0 0 0 29.146 1H4.354a3 3 0 0 0-2.56 4.566L16.75 31z');\n        path.setAttribute('stroke', '#979797');\n        path.setAttribute('fill', DEFAULT_FILL_COLOR);\n\n        el.appendChild(path);\n\n        this.style(el, {\n            width: this.markerWidth + 'px',\n            height: this.markerHeight + 'px',\n            cursor: 'pointer',\n            'z-index': 5\n        });\n        return el;\n    }\n\n    _createPlayheadElement() {\n        const el = document.createElement('playhead');\n        el.className = 'wavesurfer-playhead';\n\n        this.style(el, {\n            position: 'absolute',\n            height: '100%',\n            display: 'flex',\n            'flex-direction': 'column'\n        });\n\n        const pointer = this._createPointerSVG();\n        el.appendChild(pointer);\n\n        pointer.addEventListener('click', e => {\n            e.stopPropagation();\n            this.wavesurfer.setCurrentTime(this.playheadTime);\n        });\n\n        const line = document.createElement('div');\n        this.style(line, {\n            'flex-grow': 1,\n            'margin-left': (this.markerWidth / 2 - 0.5) + 'px',\n            background: 'black',\n            width: '1px',\n            opacity: 0.1\n        });\n\n        el.appendChild(line);\n\n        this.element = el;\n        this.wrapper.appendChild(el);\n    }\n\n    _updatePlayheadPosition() {\n        if (!this.element) {\n            return;\n        }\n\n        const duration = this.wavesurfer.getDuration();\n        const elementWidth =\n            this.wavesurfer.drawer.width /\n            this.wavesurfer.params.pixelRatio;\n\n        const positionPct = this.playheadTime / duration;\n        this.style(this.element, {\n            left: ((elementWidth * positionPct) - (this.markerWidth / 2)) + 'px'\n        });\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/plugin/playhead/index.js\");\n",""],"names":["DEFAULT_FILL_COLOR","PlayheadPlugin","params","ws","options","forEach","opt","wavesurfer","util","style","markerWidth","markerHeight","playheadTime","unFuns","_onResize","_updatePlayheadPosition","_onReady","wrapper","drawer","draw","_createPlayheadElement","window","addEventListener","wavesurferOn","returnOnPause","setCurrentTime","moveOnSeek","getCurrentTime","ev","fn","ret","on","push","un","isReady","_onBackendCreated","r","once","f","removeChild","element","removeEventListener","time","isPlaying","svgNS","el","document","createElementNS","path","setAttribute","appendChild","width","height","cursor","createElement","className","position","display","pointer","_createPointerSVG","e","stopPropagation","line","background","opacity","duration","getDuration","elementWidth","pixelRatio","positionPct","left","name","deferInit","instance"],"sourceRoot":""}