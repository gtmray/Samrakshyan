{"version":3,"file":"wavesurfer.markers.js","mappings":"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","sources":["webpack://WaveSurfer/webpack/universalModuleDefinition","webpack://WaveSurfer/./src/plugin/markers/index.js","webpack://WaveSurfer/webpack/bootstrap","webpack://WaveSurfer/webpack/before-startup","webpack://WaveSurfer/webpack/startup","webpack://WaveSurfer/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"markers\"] = factory();\n})(self, () => {\nreturn ","/**\n * @typedef {Object} MarkerParams\n * @desc The parameters used to describe a marker.\n * @example wavesurfer.addMarker(regionParams);\n * @property {number} time The time to set the marker at\n * @property {?label} string An optional marker label\n * @property {?color} string Background color for marker\n * @property {?position} string \"top\" or \"bottom\", defaults to \"bottom\"\n * @property {?markerElement} element An HTML element to display instead of the default marker image\n * @property {?draggable} boolean Set marker as draggable, defaults to false\n */\n\n\n/**\n * Markers are points in time in the audio that can be jumped to.\n *\n * @implements {PluginClass}\n *\n * @example\n * import MarkersPlugin from 'wavesurfer.markers.js';\n *\n * // if you are using <script> tags\n * var MarkerPlugin = window.WaveSurfer.markers;\n *\n * // ... initialising wavesurfer with the plugin\n * var wavesurfer = WaveSurfer.create({\n *   // wavesurfer options ...\n *   plugins: [\n *     MarkersPlugin.create({\n *       // plugin options ...\n *     })\n *   ]\n * });\n */\n\nconst DEFAULT_FILL_COLOR = \"#D8D8D8\";\nconst DEFAULT_POSITION = \"bottom\";\n\nexport default class MarkersPlugin {\n    /**\n     * @typedef {Object} MarkersPluginParams\n     * @property {?MarkerParams[]} markers Initial set of markers\n     * @fires MarkersPlugin#marker-click\n     * @fires MarkersPlugin#marker-drag\n     * @fires MarkersPlugin#marker-drop\n     */\n\n    /**\n     * Markers plugin definition factory\n     *\n     * This function must be used to create a plugin definition which can be\n     * used by wavesurfer to correctly instantiate the plugin.\n     *\n     * @param {MarkersPluginParams} params parameters use to initialise the plugin\n     * @since 4.6.0\n     * @return {PluginDefinition} an object representing the plugin\n     */\n    static create(params) {\n        return {\n            name: 'markers',\n            deferInit: params && params.deferInit ? params.deferInit : false,\n            params: params,\n            staticProps: {\n                addMarker(options) {\n                    if (!this.initialisedPluginList.markers) {\n                        this.initPlugin('markers');\n                    }\n                    return this.markers.add(options);\n                },\n                clearMarkers() {\n                    this.markers && this.markers.clear();\n                }\n            },\n            instance: MarkersPlugin\n        };\n    }\n\n    constructor(params, ws) {\n        this.params = params;\n        this.wavesurfer = ws;\n        this.util = ws.util;\n        this.style = this.util.style;\n        this.markerLineWidth = 1;\n        this.markerWidth = 11;\n        this.markerHeight = 22;\n        this.dragging = false;\n\n\n        this._onResize = () => {\n            this._updateMarkerPositions();\n        };\n\n        this._onBackendCreated = () => {\n            this.wrapper = this.wavesurfer.drawer.wrapper;\n            if (this.params.markers) {\n                this.params.markers.forEach(marker => this.add(marker));\n            }\n            window.addEventListener('resize', this._onResize, true);\n            window.addEventListener('orientationchange', this._onResize, true);\n            this.wavesurfer.on('zoom', this._onResize);\n\n            if (!this.markers.find(marker => marker.draggable)){\n                return;\n            }\n\n            this.onMouseMove = (e) => this._onMouseMove(e);\n            window.addEventListener('mousemove', this.onMouseMove);\n\n            this.onMouseUp = (e) => this._onMouseUp(e);\n            window.addEventListener(\"mouseup\", this.onMouseUp);\n        };\n\n        this.markers = [];\n        this._onReady = () => {\n            this.wrapper = this.wavesurfer.drawer.wrapper;\n            this._updateMarkerPositions();\n        };\n    }\n\n    init() {\n        // Check if ws is ready\n        if (this.wavesurfer.isReady) {\n            this._onBackendCreated();\n            this._onReady();\n        } else {\n            this.wavesurfer.once('ready', this._onReady);\n            this.wavesurfer.once('backend-created', this._onBackendCreated);\n        }\n    }\n\n    destroy() {\n        this.wavesurfer.un('ready', this._onReady);\n        this.wavesurfer.un('backend-created', this._onBackendCreated);\n\n        this.wavesurfer.un('zoom', this._onResize);\n\n        window.removeEventListener('resize', this._onResize, true);\n        window.removeEventListener('orientationchange', this._onResize, true);\n\n        if (this.onMouseMove) {\n            window.removeEventListener('mousemove', this.onMouseMove);\n        }\n        if (this.onMouseUp) {\n            window.removeEventListener(\"mouseup\", this.onMouseUp);\n        }\n\n        this.clear();\n    }\n\n    /**\n     * Add a marker\n     *\n     * @param {MarkerParams} params Marker definition\n     * @return {object} The created marker\n     */\n    add(params) {\n        let marker = {\n            time: params.time,\n            label: params.label,\n            color: params.color || DEFAULT_FILL_COLOR,\n            position: params.position || DEFAULT_POSITION,\n            draggable: !!params.draggable\n        };\n\n        marker.el = this._createMarkerElement(marker, params.markerElement);\n\n        this.wrapper.appendChild(marker.el);\n        this.markers.push(marker);\n        this._updateMarkerPositions();\n\n        return marker;\n    }\n\n    /**\n     * Remove a marker\n     *\n     * @param {number} index Index of the marker to remove\n     */\n    remove(index) {\n        let marker = this.markers[index];\n        if (!marker) {\n            return;\n        }\n\n        this.wrapper.removeChild(marker.el);\n        this.markers.splice(index, 1);\n    }\n\n    _createPointerSVG(color, position) {\n        const svgNS = \"http://www.w3.org/2000/svg\";\n\n        const el = document.createElementNS(svgNS, \"svg\");\n        const polygon = document.createElementNS(svgNS, \"polygon\");\n\n        el.setAttribute(\"viewBox\", \"0 0 40 80\");\n\n        polygon.setAttribute(\"id\", \"polygon\");\n        polygon.setAttribute(\"stroke\", \"#979797\");\n        polygon.setAttribute(\"fill\", color);\n        polygon.setAttribute(\"points\", \"20 0 40 30 40 80 0 80 0 30\");\n        if ( position == \"top\" ) {\n            polygon.setAttribute(\"transform\", \"rotate(180, 20 40)\");\n        }\n\n        el.appendChild(polygon);\n\n        this.style(el, {\n            width: this.markerWidth + \"px\",\n            height: this.markerHeight + \"px\",\n            \"min-width\": this.markerWidth + \"px\",\n            \"margin-right\": \"5px\",\n            \"z-index\": 4\n        });\n        return el;\n    }\n\n    _createMarkerElement(marker, markerElement) {\n        let label = marker.label;\n\n        const el = document.createElement('marker');\n        el.className = \"wavesurfer-marker\";\n\n        this.style(el, {\n            position: \"absolute\",\n            height: \"100%\",\n            display: \"flex\",\n            overflow: \"hidden\",\n            \"flex-direction\": (marker.position == \"top\" ? \"column-reverse\" : \"column\")\n        });\n\n        const line = document.createElement('div');\n        const width = markerElement ? markerElement.width : this.markerWidth;\n        marker.offset = (width - this.markerLineWidth) / 2;\n        this.style(line, {\n            \"flex-grow\": 1,\n            \"margin-left\": marker.offset + \"px\",\n            background: \"black\",\n            width: this.markerLineWidth + \"px\",\n            opacity: 0.1\n        });\n        el.appendChild(line);\n\n        const labelDiv = document.createElement('div');\n        const point = markerElement || this._createPointerSVG(marker.color, marker.position);\n        if (marker.draggable){\n            point.draggable = false;\n        }\n        labelDiv.appendChild(point);\n\n        if ( label ) {\n            const labelEl = document.createElement('span');\n            labelEl.innerText = label;\n            this.style(labelEl, {\n                \"font-family\": \"monospace\",\n                \"font-size\": \"90%\"\n            });\n            labelDiv.appendChild(labelEl);\n        }\n\n        this.style(labelDiv, {\n            display: \"flex\",\n            \"align-items\": \"center\",\n            cursor: \"pointer\"\n        });\n\n        el.appendChild(labelDiv);\n\n        labelDiv.addEventListener(\"click\", e => {\n            e.stopPropagation();\n            // Click event is caught when the marker-drop event was dispatched.\n            // Drop event was dispatched at this moment, but this.dragging\n            // is waiting for the next tick to set as false\n            if (this.dragging){\n                return;\n            }\n            this.wavesurfer.setCurrentTime(marker.time);\n            this.wavesurfer.fireEvent(\"marker-click\", marker, e);\n        });\n\n        if (marker.draggable) {\n            labelDiv.addEventListener(\"mousedown\", e => {\n                this.selectedMarker = marker;\n            });\n        }\n        return el;\n    }\n\n    _updateMarkerPositions() {\n        for ( let i = 0 ; i < this.markers.length; i++ ) {\n            let marker = this.markers[i];\n            this._updateMarkerPosition(marker);\n        }\n    }\n\n    /**\n     * Update a marker position based on its time property.\n     *\n     * @private\n     * @param {MarkerParams} params The marker to update.\n     * @returns {void}\n     */\n    _updateMarkerPosition(params) {\n        const duration = this.wavesurfer.getDuration();\n        const elementWidth =\n            this.wavesurfer.drawer.width /\n            this.wavesurfer.params.pixelRatio;\n\n        const positionPct = Math.min(params.time / duration, 1);\n        const leftPx = ((elementWidth * positionPct) - params.offset);\n        this.style(params.el, {\n            \"left\": leftPx + \"px\",\n            \"max-width\": (elementWidth - leftPx) + \"px\"\n        });\n    }\n\n    /**\n     * Fires `marker-drag` event, update the `time` property for the\n     * selected marker based on the mouse position, and calls to update\n     * its position.\n     *\n     * @private\n     * @param {MouseEvent} event The mouse event.\n     * @returns {void}\n     */\n    _onMouseMove(event) {\n        if (!this.selectedMarker){\n            return;\n        }\n        if (!this.dragging){\n            this.dragging = true;\n            this.wavesurfer.fireEvent(\"marker-drag\", this.selectedMarker, event);\n        }\n        this.selectedMarker.time = this.wavesurfer.drawer.handleEvent(event) * this.wavesurfer.getDuration();\n        this._updateMarkerPositions();\n    }\n\n    /**\n     * Fires `marker-drop` event and unselect the dragged marker.\n     *\n     * @private\n     * @param {MouseEvent} event The mouse event.\n     * @returns {void}\n     */\n    _onMouseUp(event) {\n        if (this.selectedMarker) {\n            setTimeout(() => {\n                this.selectedMarker = false;\n                this.dragging = false;\n            }, 0);\n        }\n\n        if (!this.dragging) {\n            return;\n        }\n\n        event.stopPropagation();\n        const duration = this.wavesurfer.getDuration();\n        this.selectedMarker.time = this.wavesurfer.drawer.handleEvent(event) * duration;\n        this._updateMarkerPositions();\n        this.wavesurfer.fireEvent(\"marker-drop\", this.selectedMarker, event);\n    }\n\n    /**\n     * Remove all markers\n     */\n    clear() {\n        while ( this.markers.length > 0 ) {\n            this.remove(0);\n        }\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/plugin/markers/index.js\");\n",""],"names":["DEFAULT_FILL_COLOR","DEFAULT_POSITION","MarkersPlugin","params","ws","wavesurfer","util","style","markerLineWidth","markerWidth","markerHeight","dragging","_onResize","_updateMarkerPositions","_onBackendCreated","wrapper","drawer","markers","forEach","marker","add","window","addEventListener","on","find","draggable","onMouseMove","e","_onMouseMove","onMouseUp","_onMouseUp","_onReady","isReady","once","un","removeEventListener","clear","time","label","color","position","el","_createMarkerElement","markerElement","appendChild","push","index","removeChild","splice","svgNS","document","createElementNS","polygon","setAttribute","width","height","createElement","className","display","overflow","line","offset","background","opacity","labelDiv","point","_createPointerSVG","labelEl","innerText","cursor","stopPropagation","setCurrentTime","fireEvent","selectedMarker","i","length","_updateMarkerPosition","duration","getDuration","elementWidth","pixelRatio","positionPct","Math","min","leftPx","event","handleEvent","setTimeout","remove","name","deferInit","staticProps","addMarker","options","initialisedPluginList","initPlugin","clearMarkers","instance"],"sourceRoot":""}