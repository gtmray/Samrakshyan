import*as t from"react";import n,{createContext as e,useContext as r,useLayoutEffect as o,useEffect as a,useState as i,useRef as s,useCallback as c,useMemo as l,forwardRef as u,createElement as f}from"react";const d=("undefined"==typeof process||process.env,"production"),p=t=>({isEnabled:n=>t.some(t=>!!n[t])}),m={measureLayout:p(["layout","layoutId","drag"]),animation:p(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"]),exit:p(["exit"]),drag:p(["drag","dragControls"]),focus:p(["whileFocus"]),hover:p(["whileHover","onHoverStart","onHoverEnd"]),tap:p(["whileTap","onTap","onTapStart","onTapCancel"]),pan:p(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),inView:p(["whileInView","onViewportEnter","onViewportLeave"])};const g=e({strict:!1}),y=Object.keys(m),h=y.length;const v=e({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),b=e({});const w=e(null),O="undefined"!=typeof document,j=O?o:a,S={current:null};let x=!1;function E(){!x&&function(){if(x=!0,O)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),n=()=>S.current=t.matches;t.addListener(n),n()}else S.current=!1}();const[t]=i(S.current);return t}function P(t,n,e,o){const i=r(g),c=r(b).visualElement,l=r(w),u=function(){const t=E(),{reducedMotion:n}=r(v);return"never"!==n&&("always"===n||t)}(),f=s(void 0);o||(o=i.renderer),!f.current&&o&&(f.current=o(t,{visualState:n,parent:c,props:e,presenceId:null==l?void 0:l.id,blockInitialAnimation:!1===(null==l?void 0:l.initial),shouldReduceMotion:u}));const d=f.current;return j(()=>{null==d||d.syncRender()}),a(()=>{var t;null===(t=null==d?void 0:d.animationState)||void 0===t||t.animateChanges()}),j(()=>()=>null==d?void 0:d.notifyUnmount(),[]),d}function C(t){return"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}function T(t){return"string"==typeof t||function(t){return Array.isArray(t)}(t)}function V(t){var n;return"function"==typeof(null===(n=t.animate)||void 0===n?void 0:n.start)||T(t.initial)||T(t.animate)||T(t.whileHover)||T(t.whileDrag)||T(t.whileTap)||T(t.whileFocus)||T(t.exit)}function L(t){const{initial:n,animate:e}=function(t,n){if(V(t)){const{initial:n,animate:e}=t;return{initial:!1===n||T(n)?n:void 0,animate:T(e)?e:void 0}}return!1!==t.inherit?n:{}}(t,r(b));return l(()=>({initial:n,animate:e}),[k(n),k(e)])}function k(t){return Array.isArray(t)?t.join(" "):t}function A(t){const n=s(null);return null===n.current&&(n.current=t()),n.current}const M=!1;let R=1;const B=e({}),D=e({});class X extends n.Component{getSnapshotBeforeUpdate(){return this.updateProps(),null}componentDidUpdate(){}updateProps(){const{visualElement:t,props:n}=this.props;t&&t.setProps(n)}render(){return this.props.children}}function Y({preloadedFeatures:n,createVisualElement:e,projectionNodeConstructor:o,useRender:a,useVisualState:i,Component:s}){return n&&function(t){for(const n in t)null!==t[n]&&("projectionNodeConstructor"===n?m.projectionNodeConstructor=t[n]:m[n].Component=t[n])}(n),u((function(l,u){const f=function({layoutId:t}){var n;const e=null===(n=r(B))||void 0===n?void 0:n.id;return e&&void 0!==t?e+"-"+t:t}(l);l=Object.assign(Object.assign({},l),{layoutId:f});const p=r(v);let w=null;const j=L(l),S=p.isStatic?void 0:A(()=>{if(M)return R++}),x=i(l,p.isStatic);return!p.isStatic&&O&&(j.visualElement=P(s,x,Object.assign(Object.assign({},p),l),e),function(t,{layoutId:n,layout:e,drag:o,dragConstraints:a,layoutScroll:i},s,c){var l;const u=r(D);c&&s&&!(null==s?void 0:s.projection)&&(s.projection=new c(t,s.getLatestValues(),null===(l=s.parent)||void 0===l?void 0:l.projection),s.projection.setOptions({layoutId:n,layout:e,alwaysMeasureLayout:Boolean(o)||a&&C(a),visualElement:s,scheduleRender:()=>s.scheduleRender(),animationType:"string"==typeof e?e:"both",initialPromotionConfig:u,layoutScroll:i}))}(S,l,j.visualElement,o||m.projectionNodeConstructor),w=function(n,e,o){const a=[],i=r(g);if(!e)return null;"production"!==d&&o&&i.strict;for(let r=0;r<h;r++){const o=y[r],{isEnabled:i,Component:s}=m[o];i(n)&&s&&a.push(t.createElement(s,Object.assign({key:o},n,{visualElement:e})))}return a}(l,j.visualElement,n)),t.createElement(X,{visualElement:j.visualElement,props:Object.assign(Object.assign({},p),l)},w,t.createElement(b.Provider,{value:j},a(s,l,S,function(t,n,e){return c(r=>{var o;r&&(null===(o=t.mount)||void 0===o||o.call(t,r)),n&&(r?n.mount(r):n.unmount()),e&&("function"==typeof e?e(r):C(e)&&(e.current=r))},[n])}(x,j.visualElement,u),x,p.isStatic,j.visualElement)))}))}const H=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function I(t){return"string"==typeof t&&!t.includes("-")&&!!(H.indexOf(t)>-1||/[A-Z]/.test(t))}const W={},$=["","X","Y","Z"],F=["transformPerspective","x","y","z"];function Z(t,n){return F.indexOf(t)-F.indexOf(n)}["translate","scale","rotate","skew"].forEach(t=>$.forEach(n=>F.push(t+n)));const z=new Set(F);function U(t){return z.has(t)}const N=new Set(["originX","originY","originZ"]);function K(t){return N.has(t)}function q(t,{layout:n,layoutId:e}){return U(t)||K(t)||(n||void 0!==e)&&(!!W[t]||"opacity"===t)}const _=t=>Boolean(null!==t&&"object"==typeof t&&t.getVelocity),G={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function J(t){return t.startsWith("--")}const Q=(t,n)=>n&&"number"==typeof t?n.transform(t):t;const tt={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},nt=Object.assign(Object.assign({},tt),{transform:(et=0,rt=1,t=>Math.max(Math.min(t,rt),et))});var et,rt;const ot=Object.assign(Object.assign({},tt),{default:1}),at=t=>({test:n=>function(t){return"string"==typeof t}(n)&&n.endsWith(t)&&1===n.split(" ").length,parse:parseFloat,transform:n=>`${n}${t}`}),it=at("deg"),st=at("%"),ct=at("px"),lt=Object.assign(Object.assign({},st),{parse:t=>st.parse(t)/100,transform:t=>st.transform(100*t)}),ut=Object.assign(Object.assign({},tt),{transform:Math.round}),ft={borderWidth:ct,borderTopWidth:ct,borderRightWidth:ct,borderBottomWidth:ct,borderLeftWidth:ct,borderRadius:ct,radius:ct,borderTopLeftRadius:ct,borderTopRightRadius:ct,borderBottomRightRadius:ct,borderBottomLeftRadius:ct,width:ct,maxWidth:ct,height:ct,maxHeight:ct,size:ct,top:ct,right:ct,bottom:ct,left:ct,padding:ct,paddingTop:ct,paddingRight:ct,paddingBottom:ct,paddingLeft:ct,margin:ct,marginTop:ct,marginRight:ct,marginBottom:ct,marginLeft:ct,rotate:it,rotateX:it,rotateY:it,rotateZ:it,scale:ot,scaleX:ot,scaleY:ot,scaleZ:ot,skew:it,skewX:it,skewY:it,distance:ct,translateX:ct,translateY:ct,translateZ:ct,x:ct,y:ct,z:ct,perspective:ct,transformPerspective:ct,opacity:nt,originX:lt,originY:lt,originZ:ct,zIndex:ut,fillOpacity:nt,strokeOpacity:nt,numOctaves:ut};function dt(t,n,e,r){var o;const{style:a,vars:i,transform:s,transformKeys:c,transformOrigin:l}=t;c.length=0;let u=!1,f=!1,d=!0;for(const t in n){const e=n[t];if(J(t)){i[t]=e;continue}const r=ft[t],p=Q(e,r);if(U(t)){if(u=!0,s[t]=p,c.push(t),!d)continue;e!==(null!==(o=r.default)&&void 0!==o?o:0)&&(d=!1)}else K(t)?(l[t]=p,f=!0):a[t]=p}u?a.transform=function({transform:t,transformKeys:n},{enableHardwareAcceleration:e=!0,allowTransformNone:r=!0},o,a){let i="";n.sort(Z);let s=!1;const c=n.length;for(let e=0;e<c;e++){const r=n[e];i+=`${G[r]||r}(${t[r]}) `,"z"===r&&(s=!0)}return!s&&e&&(i+="translateZ(0)"),i=i.trim(),a?i=a(t,o?"":i):r&&o&&(i="none"),i}(t,e,d,r):r?a.transform=r({},""):!n.transform&&a.transform&&(a.transform="none"),f&&(a.transformOrigin=function({originX:t="50%",originY:n="50%",originZ:e=0}){return`${t} ${n} ${e}`}(l))}const pt=()=>({style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}});function mt(t,n,e){for(const r in n)_(n[r])||q(r,e)||(t[r]=n[r])}function gt(t,n,e){let r={};return mt(r,t.style||{},t),Object.assign(r,function({transformTemplate:t},n,e){return l(()=>{const r={style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}};dt(r,n,{enableHardwareAcceleration:!e},t);const{vars:o,style:a}=r;return Object.assign(Object.assign({},o),a)},[n])}(t,n,e)),t.transformValues&&(r=t.transformValues(r)),r}function yt(t,n,e){const r={},o=gt(t,n,e);return Boolean(t.drag)&&!1!==t.dragListener&&(r.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=!0===t.drag?"none":"pan-"+("x"===t.drag?"y":"x")),r.style=o,r}const ht=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","layoutDependency","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","dragSnapToOrigin","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover","whileInView","onViewportEnter","onViewportLeave","viewport","layoutScroll"]);function vt(t){return ht.has(t)}let bt=t=>!vt(t);try{(wt=require("@emotion/is-prop-valid").default)&&(bt=t=>t.startsWith("on")?!vt(t):wt(t))}catch(t){}var wt;function Ot(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]])}return e}function jt(t,n,e){return"string"==typeof t?t:ct.transform(n+e*t)}const St={offset:"stroke-dashoffset",array:"stroke-dasharray"},xt={offset:"strokeDashoffset",array:"strokeDasharray"};function Et(t,n,e,r){var{attrX:o,attrY:a,originX:i,originY:s,pathLength:c,pathSpacing:l=1,pathOffset:u=0}=n;dt(t,Ot(n,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),e,r),t.attrs=t.style,t.style={};const{attrs:f,style:d,dimensions:p}=t;f.transform&&(p&&(d.transform=f.transform),delete f.transform),p&&(void 0!==i||void 0!==s||d.transform)&&(d.transformOrigin=function(t,n,e){return`${jt(n,t.x,t.width)} ${jt(e,t.y,t.height)}`}(p,void 0!==i?i:.5,void 0!==s?s:.5)),void 0!==o&&(f.x=o),void 0!==a&&(f.y=a),void 0!==c&&function(t,n,e=1,r=0,o=!0){t.pathLength=1;const a=o?St:xt;t[a.offset]=ct.transform(-r);const i=ct.transform(n),s=ct.transform(e);t[a.array]=`${i} ${s}`}(f,c,l,u,!1)}const Pt=()=>Object.assign(Object.assign({},{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}),{attrs:{}});function Ct(t,n){const e=l(()=>{const e=Pt();return Et(e,n,{enableHardwareAcceleration:!1},t.transformTemplate),Object.assign(Object.assign({},e.attrs),{style:Object.assign({},e.style)})},[n]);if(t.style){const n={};mt(n,t.style,t),e.style=Object.assign(Object.assign({},n),e.style)}return e}function Tt(t=!1){return(n,e,r,o,{latestValues:a},i)=>{const s=(I(n)?Ct:yt)(e,a,i),c=function(t,n,e){const r={};for(const o in t)(bt(o)||!0===e&&vt(o)||!n&&!vt(o)||t.draggable&&o.startsWith("onDrag"))&&(r[o]=t[o]);return r}(e,"string"==typeof n,t),l=Object.assign(Object.assign(Object.assign({},c),s),{ref:o});return r&&(l["data-projection-id"]=r),f(n,l)}}const Vt=/([a-z])([A-Z])/g;const Lt=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength"]);function kt(t,n,e,r){!function(t,{style:n,vars:e},r,o){Object.assign(t.style,n,o&&o.getProjectionStyles(r));for(const n in e)t.style.setProperty(n,e[n])}(t,n,void 0,r);for(const e in n.attrs)t.setAttribute(Lt.has(e)?e:e.replace(Vt,"$1-$2").toLowerCase(),n.attrs[e])}function At(t){const{style:n}=t,e={};for(const r in n)(_(n[r])||q(r,t))&&(e[r]=n[r]);return e}function Mt(t){const n=_(t)?t.get():t;return e=n,Boolean(e&&"object"==typeof e&&e.mix&&e.toValue)?n.toValue():n;var e}function Rt({scrapeMotionValuesFromProps:t,createRenderState:n,onMount:e},r,o,a){const i={latestValues:Dt(r,o,a,t),renderState:n()};return e&&(i.mount=t=>e(r,t,i)),i}const Bt=t=>(n,e)=>{const o=r(b),a=r(w);return e?Rt(t,n,o,a):A(()=>Rt(t,n,o,a))};function Dt(t,n,e,r){const o={},a=!1===(null==e?void 0:e.initial),i=r(t);for(const t in i)o[t]=Mt(i[t]);let{initial:s,animate:c}=t;const l=V(t),u=function(t){return Boolean(V(t)||t.variants)}(t);n&&u&&!l&&!1!==t.inherit&&(null!=s||(s=n.initial),null!=c||(c=n.animate));const f=a||!1===s,d=f?c:s;if(d&&"boolean"!=typeof d&&("object"!=typeof(p=d)||"function"!=typeof p.start)){(Array.isArray(d)?d:[d]).forEach(n=>{const e=function(t,n,e,r={},o={}){var a;return"function"==typeof n&&(n=n(null!=e?e:t.custom,r,o)),"string"==typeof n&&(n=null===(a=t.variants)||void 0===a?void 0:a[n]),"function"==typeof n&&(n=n(null!=e?e:t.custom,r,o)),n}(t,n);if(!e)return;const{transitionEnd:r,transition:a}=e,i=Ot(e,["transitionEnd","transition"]);for(const t in i){let n=i[t];if(Array.isArray(n)){n=n[f?n.length-1:0]}null!==n&&(o[t]=n)}for(const t in r)o[t]=r[t]})}var p;return o}const Xt={useVisualState:Bt({scrapeMotionValuesFromProps:function(t){const n=At(t);for(const e in t)if(_(t[e])){n["x"===e||"y"===e?"attr"+e.toUpperCase():e]=t[e]}return n},createRenderState:Pt,onMount:(t,n,{renderState:e,latestValues:r})=>{try{e.dimensions="function"==typeof n.getBBox?n.getBBox():n.getBoundingClientRect()}catch(t){e.dimensions={x:0,y:0,width:0,height:0}}Et(e,r,{enableHardwareAcceleration:!1},t.transformTemplate),kt(n,e)}})},Yt={useVisualState:Bt({scrapeMotionValuesFromProps:At,createRenderState:pt})};const Ht=function(t){function n(n,e={}){return Y(t(n,e))}if("undefined"==typeof Proxy)return n;const e=new Map;return new Proxy(n,{get:(t,r)=>(e.has(r)||e.set(r,n(r)),e.get(r))})}((function(t,{forwardMotionProps:n=!1},e,r,o){const a=I(t)?Xt:Yt;return Object.assign(Object.assign({},a),{preloadedFeatures:e,useRender:Tt(n),createVisualElement:r,projectionNodeConstructor:o,Component:t})}));export{Ht as m};
